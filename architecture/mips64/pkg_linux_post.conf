# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: architecture/mips64/pkg_linux_post.conf
# Copyright (C) 2004 - 2024 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

hack_install_initrd() {
	# until we fix arcload initrd & iso9660 :-/
	echo 'CONFIG_INITRAMFS_SOURCE=" "' >> .config
	eval $MAKE $makeopt vmlinux
	cp $root/boot/initrd-$ver-t2 usr/initramfs_data.cpio.gz
	touch usr/initramfs_data.cpio.gz
	eval $MAKE $makeopt vmlinux
	cp -vf vmlinux $root/boot/vmlinux-$ver-t2

	if [ -e $root/TOOLCHAIN/isofs/boot/initrd-$ver-t2 ]; then
		cp $root/TOOLCHAIN/isofs/boot/initrd-$ver-t2 usr/initramfs_data.cpio.gz
		touch usr/initramfs_data.cpio.gz
		eval $MAKE $makeopt vmlinux
		cp -vf vmlinux $root/TOOLCHAIN/isofs/boot/install
	fi
}
#hook_add postmake 9 hack_install_initrd

# Sgi O2 r10k++ -mmr10k-cache-barrier=load-store appears to break w/ -Os
KCC_WRAPPER_INSERT="${KCC_WRAPPER_INSERT/-Os/-O1}"
